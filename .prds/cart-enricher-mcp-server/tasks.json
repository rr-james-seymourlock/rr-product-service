{
  "prdFilename": "cart-enricher-mcp-server",
  "tasks": [
    {
      "id": "1",
      "title": "Create MCP server scaffold for cart-enricher",
      "description": "Set up the base MCP server structure in the existing mcp-server package to host cart-enricher analysis tools",
      "status": "done",
      "priority": "high",
      "dependencies": [],
      "details": "Extend existing mcp-server package with cart-enricher tool namespace. Follow patterns from store onboarding MCP tools.",
      "testStrategy": "Verify MCP server starts and new tools are discoverable",
      "subtasks": [],
      "userStoryId": "US009",
      "createdAt": "2025-12-18T18:39:52.690Z",
      "updatedAt": "2025-12-18T18:47:39.029Z",
      "complexity": 3,
      "recommendedSubtasks": 2,
      "completedAt": "2025-12-18T18:47:39.029Z"
    },
    {
      "id": "2",
      "title": "Implement cart_analyze_session MCP tool",
      "description": "Create MCP tool that accepts raw product views and cart events, extracts store metadata, and generates a structured analysis report",
      "status": "pending",
      "priority": "high",
      "dependencies": ["1"],
      "details": "Tool should: (1) Accept productViews and cartEvents arrays, (2) Extract storeId, storeName, domain from data, (3) Identify unique products vs duplicates, (4) Trace cart evolution across snapshots, (5) Return structured analysis report",
      "testStrategy": "Test with Macy's fixture data and verify report matches manual analysis",
      "subtasks": [
        {
          "id": "2.1",
          "title": "Research and design for implement cart_analyze_session mcp tool",
          "description": "Implementation step 1 for: Implement cart_analyze_session MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": [],
          "subtasks": [],
          "userStoryId": "US001",
          "createdAt": "2025-12-18T18:40:15.322Z",
          "updatedAt": "2025-12-18T18:40:15.322Z"
        },
        {
          "id": "2.2",
          "title": "Set up foundation for implement cart_analyze_session mcp tool",
          "description": "Implementation step 2 for: Implement cart_analyze_session MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["2.1"],
          "subtasks": [],
          "userStoryId": "US001",
          "createdAt": "2025-12-18T18:40:15.322Z",
          "updatedAt": "2025-12-18T18:40:15.322Z"
        },
        {
          "id": "2.3",
          "title": "Implement core logic for implement cart_analyze_session mcp tool",
          "description": "Implementation step 3 for: Implement cart_analyze_session MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["2.2"],
          "subtasks": [],
          "userStoryId": "US001",
          "createdAt": "2025-12-18T18:40:15.322Z",
          "updatedAt": "2025-12-18T18:40:15.322Z"
        }
      ],
      "userStoryId": "US001",
      "createdAt": "2025-12-18T18:39:52.779Z",
      "updatedAt": "2025-12-18T18:40:15.322Z",
      "complexity": 5,
      "recommendedSubtasks": 3
    },
    {
      "id": "3",
      "title": "Implement cart_predict_matches MCP tool",
      "description": "Create MCP tool that predicts which matching strategies will apply to each cart item with confidence levels",
      "status": "pending",
      "priority": "high",
      "dependencies": ["2"],
      "details": "Tool should: (1) Analyze cart items against product views, (2) Predict matching strategy (sku, url, extracted_id, etc.), (3) Assign confidence level with rationale, (4) Identify items that may not match, (5) Note fallback strategies",
      "testStrategy": "Validate predictions against actual enricher results on existing fixtures",
      "subtasks": [
        {
          "id": "3.1",
          "title": "Research and design for implement cart_predict_matches mcp tool",
          "description": "Implementation step 1 for: Implement cart_predict_matches MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": [],
          "subtasks": [],
          "userStoryId": "US002",
          "createdAt": "2025-12-18T18:40:15.350Z",
          "updatedAt": "2025-12-18T18:40:15.350Z"
        },
        {
          "id": "3.2",
          "title": "Set up foundation for implement cart_predict_matches mcp tool",
          "description": "Implementation step 2 for: Implement cart_predict_matches MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["3.1"],
          "subtasks": [],
          "userStoryId": "US002",
          "createdAt": "2025-12-18T18:40:15.350Z",
          "updatedAt": "2025-12-18T18:40:15.350Z"
        },
        {
          "id": "3.3",
          "title": "Implement core logic for implement cart_predict_matches mcp tool",
          "description": "Implementation step 3 for: Implement cart_predict_matches MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["3.2"],
          "subtasks": [],
          "userStoryId": "US002",
          "createdAt": "2025-12-18T18:40:15.350Z",
          "updatedAt": "2025-12-18T18:40:15.350Z"
        }
      ],
      "userStoryId": "US002",
      "createdAt": "2025-12-18T18:39:52.872Z",
      "updatedAt": "2025-12-18T18:40:15.350Z",
      "complexity": 5,
      "recommendedSubtasks": 3
    },
    {
      "id": "4",
      "title": "Implement cart_check_store_registry MCP tool",
      "description": "Create MCP tool that verifies store is configured in store-registry for ID extraction",
      "status": "pending",
      "priority": "high",
      "dependencies": ["1"],
      "details": "Tool should: (1) Check if storeId exists in store-registry config, (2) Check if domain has test fixtures, (3) Report current ID extraction patterns, (4) Flag if store needs onboarding, (5) Integrate with store_check_exists from onboarding MCP",
      "testStrategy": "Test with configured store (Macy's) and unconfigured store",
      "subtasks": [],
      "userStoryId": "US010",
      "createdAt": "2025-12-18T18:39:52.963Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 4,
      "recommendedSubtasks": 3
    },
    {
      "id": "5",
      "title": "Implement cart_validate_id_extraction MCP tool",
      "description": "Create MCP tool that runs ID extraction on all session URLs and reports results",
      "status": "pending",
      "priority": "high",
      "dependencies": ["4"],
      "details": "Tool should: (1) Extract IDs from all product view URLs, (2) Extract IDs from cart item URLs if present, (3) Compare extracted IDs between products and cart items, (4) Report URLs that fail extraction, (5) Identify impact on matching accuracy",
      "testStrategy": "Run against fixtures with known ID patterns",
      "subtasks": [],
      "userStoryId": "US012",
      "createdAt": "2025-12-18T18:39:53.052Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 4,
      "recommendedSubtasks": 3
    },
    {
      "id": "6",
      "title": "Implement cart_review_matching_logic MCP tool",
      "description": "Create MCP tool that reviews cart-enricher code against new data patterns and identifies gaps",
      "status": "pending",
      "priority": "medium",
      "dependencies": ["2"],
      "details": "Tool should: (1) Analyze how each matching strategy applies to data, (2) Identify strategies that should match but may not, (3) Highlight edge cases, (4) Compare to existing fixtures, (5) Note normalization requirements",
      "testStrategy": "Verify identifies known gaps in existing fixtures",
      "subtasks": [],
      "userStoryId": "US003",
      "createdAt": "2025-12-18T18:39:53.139Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 3,
      "recommendedSubtasks": 2
    },
    {
      "id": "7",
      "title": "Implement cart_suggest_improvements MCP tool",
      "description": "Create MCP tool that recommends matching logic improvements based on data patterns",
      "status": "pending",
      "priority": "medium",
      "dependencies": ["6"],
      "details": "Tool should: (1) Identify new matching strategies, (2) Suggest confidence adjustments, (3) Highlight generalizable patterns, (4) Provide implementation guidance, (5) Estimate impact",
      "testStrategy": "Verify suggestions are actionable and specific",
      "subtasks": [],
      "userStoryId": "US004",
      "createdAt": "2025-12-18T18:39:53.226Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 2,
      "recommendedSubtasks": 2
    },
    {
      "id": "8",
      "title": "Implement cart_create_fixture MCP tool",
      "description": "Create MCP tool that generates cart-enricher fixture files from analyzed session data",
      "status": "pending",
      "priority": "high",
      "dependencies": ["3"],
      "details": "Tool should: (1) Generate TypeScript fixture file, (2) Include all unique product views, (3) Include representative cart events, (4) Add expectedMatches with confidence levels, (5) Follow established naming conventions",
      "testStrategy": "Generate fixture and verify it compiles and tests pass",
      "subtasks": [],
      "userStoryId": "US006",
      "createdAt": "2025-12-18T18:39:53.317Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 4,
      "recommendedSubtasks": 3
    },
    {
      "id": "9",
      "title": "Implement cart_append_store_urls MCP tool",
      "description": "Create MCP tool that adds new URL test cases to existing store-registry fixtures",
      "status": "pending",
      "priority": "medium",
      "dependencies": ["5"],
      "details": "Tool should: (1) Filter URLs to product pages only, (2) Call store_append_fixture from onboarding MCP, (3) Verify URLs extract correctly, (4) Flag non-matching URLs, (5) Run regression tests",
      "testStrategy": "Append URLs to existing fixture and verify tests pass",
      "subtasks": [],
      "userStoryId": "US013",
      "createdAt": "2025-12-18T18:39:53.423Z",
      "updatedAt": "2025-12-18T18:40:10.602Z",
      "complexity": 2,
      "recommendedSubtasks": 2
    },
    {
      "id": "10",
      "title": "Implement cart_run_full_analysis MCP tool",
      "description": "Create orchestrator MCP tool that runs the complete analysis workflow end-to-end",
      "status": "pending",
      "priority": "high",
      "dependencies": ["2", "3", "4", "5", "6", "7"],
      "details": "Tool should orchestrate: (1) analyze_session, (2) check_store_registry (trigger onboarding if needed), (3) validate_id_extraction, (4) predict_matches, (5) review_matching_logic, (6) suggest_improvements. Returns comprehensive report.",
      "testStrategy": "Run full analysis on new store data and verify all steps complete",
      "subtasks": [
        {
          "id": "10.1",
          "title": "Research and design for implement cart_run_full_analysis mcp tool",
          "description": "Implementation step 1 for: Implement cart_run_full_analysis MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": [],
          "subtasks": [],
          "userStoryId": "US007",
          "createdAt": "2025-12-18T18:40:15.376Z",
          "updatedAt": "2025-12-18T18:40:15.376Z"
        },
        {
          "id": "10.2",
          "title": "Set up foundation for implement cart_run_full_analysis mcp tool",
          "description": "Implementation step 2 for: Implement cart_run_full_analysis MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["10.1"],
          "subtasks": [],
          "userStoryId": "US007",
          "createdAt": "2025-12-18T18:40:15.376Z",
          "updatedAt": "2025-12-18T18:40:15.376Z"
        },
        {
          "id": "10.3",
          "title": "Implement core logic for implement cart_run_full_analysis mcp tool",
          "description": "Implementation step 3 for: Implement cart_run_full_analysis MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["10.2"],
          "subtasks": [],
          "userStoryId": "US007",
          "createdAt": "2025-12-18T18:40:15.376Z",
          "updatedAt": "2025-12-18T18:40:15.376Z"
        },
        {
          "id": "10.4",
          "title": "Add error handling for implement cart_run_full_analysis mcp tool",
          "description": "Implementation step 4 for: Implement cart_run_full_analysis MCP tool",
          "status": "pending",
          "priority": "high",
          "dependencies": ["10.3"],
          "subtasks": [],
          "userStoryId": "US007",
          "createdAt": "2025-12-18T18:40:15.376Z",
          "updatedAt": "2025-12-18T18:40:15.376Z"
        }
      ],
      "userStoryId": "US007",
      "createdAt": "2025-12-18T18:39:53.528Z",
      "updatedAt": "2025-12-18T18:40:15.376Z",
      "complexity": 6,
      "recommendedSubtasks": 4
    }
  ],
  "metadata": {
    "version": "1.0",
    "created": "2025-12-18T18:39:52.690Z",
    "lastUpdated": "2025-12-18T18:47:39.029Z",
    "totalTasks": 20,
    "completedTasks": 1,
    "blockedTasks": 0
  }
}
